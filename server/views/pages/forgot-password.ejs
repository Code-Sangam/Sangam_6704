<!-- Forgot Password Page -->
<section class="auth-page">
    <div class="container">
        <div class="auth-container">
            <div class="auth-card">
                <div class="auth-header">
                    <div class="auth-logo">
                        <img src="/images/logo.svg" alt="Sangam Logo" class="logo">
                    </div>
                    <h1 class="auth-title">Reset Your Password</h1>
                    <p class="auth-subtitle">
                        Enter your email address and we'll send you a link to reset your password
                    </p>
                </div>
                
                <% if (success) { %>
                    <div class="success-message">
                        <div class="success-content">
                            <i class="fas fa-check-circle"></i>
                            <div>
                                <h3>Email Sent!</h3>
                                <p><%= success %></p>
                            </div>
                        </div>
                        <div class="success-actions">
                            <a href="/auth/login" class="btn btn-primary">
                                <i class="fas fa-arrow-left"></i>
                                Back to Login
                            </a>
                        </div>
                    </div>
                <% } else { %>
                    <form class="auth-form" action="/auth/forgot-password" method="POST" id="forgot-form">
                        <div class="form-group">
                            <label for="email" class="form-label">
                                <i class="fas fa-envelope"></i>
                                Email Address
                            </label>
                            <input 
                                type="email" 
                                id="email" 
                                name="email" 
                                class="form-input" 
                                placeholder="Enter your email address"
                                required
                                autocomplete="email"
                            >
                            <div class="form-help">
                                Enter the email address associated with your account
                            </div>
                        </div>
                        
                        <button type="submit" class="btn btn-primary btn-full" id="submit-btn">
                            <i class="fas fa-paper-plane"></i>
                            Send Reset Link
                        </button>
                    </form>
                    
                    <div class="auth-divider">
                        <span>or</span>
                    </div>
                    
                    <div class="auth-alternatives">
                        <p>Remember your password?</p>
                        <a href="/auth/login" class="btn btn-outline btn-full">
                            <i class="fas fa-sign-in-alt"></i>
                            Back to Login
                        </a>
                    </div>
                <% } %>
            </div>
            
            <div class="auth-info">
                <div class="info-content">
                    <h2>Password Reset Help</h2>
                    <div class="help-steps">
                        <div class="help-step">
                            <div class="step-number">1</div>
                            <div class="step-content">
                                <h3>Enter Your Email</h3>
                                <p>Provide the email address you used to register your account</p>
                            </div>
                        </div>
                        
                        <div class="help-step">
                            <div class="step-number">2</div>
                            <div class="step-content">
                                <h3>Check Your Inbox</h3>
                                <p>We'll send you a secure link to reset your password</p>
                            </div>
                        </div>
                        
                        <div class="help-step">
                            <div class="step-number">3</div>
                            <div class="step-content">
                                <h3>Create New Password</h3>
                                <p>Follow the link to set up a new secure password</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="security-note">
                        <i class="fas fa-shield-alt"></i>
                        <div>
                            <h4>Security Note</h4>
                            <p>
                                Password reset links expire after 1 hour for your security. 
                                If you don't receive an email, check your spam folder or try again.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const form = document.getElementById('forgot-form');
    
    if (form) {
        const submitBtn = document.getElementById('submit-btn');
        const originalBtnText = submitBtn.innerHTML;
        
        // Form submission handling
        form.addEventListener('submit', function(e) {
            // Show loading state
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Sending...';
            
            // Re-enable button after 10 seconds as fallback
            setTimeout(() => {
                submitBtn.disabled = false;
                submitBtn.innerHTML = originalBtnText;
            }, 10000);
        });
        
        // Email validation
        const emailInput = document.getElementById('email');
        emailInput.addEventListener('blur', function() {
            validateEmail(this);
        });
        
        emailInput.addEventListener('input', function() {
            clearFieldError(this);
        });
    }
});

function validateEmail(field) {
    const email = field.value.trim();
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    
    if (!email) {
        showFieldError(field, 'Email is required');
        return false;
    } else if (!emailRegex.test(email)) {
        showFieldError(field, 'Please enter a valid email address');
        return false;
    } else {
        clearFieldError(field);
        return true;
    }
}

function showFieldError(field, message) {
    clearFieldError(field);
    
    field.classList.add('error');
    
    const errorDiv = document.createElement('div');
    errorDiv.className = 'field-error';
    errorDiv.textContent = message;
    
    field.parentElement.appendChild(errorDiv);
}

function clearFieldError(field) {
    field.classList.remove('error');
    
    const existingError = field.parentElement.querySelector('.field-error');
    if (existingError) {
        existingError.remove();
    }
}
</script>

<style>
.form-help {
    font-size: var(--text-sm);
    color: var(--text-secondary);
    margin-top: 0.5rem;
    line-height: var(--leading-relaxed);
}

.success-message {
    text-align: center;
    padding: 2rem;
    background: var(--background-secondary);
    border-radius: var(--radius-lg);
    border: 1px solid var(--success-color);
}

.success-content {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 1rem;
    margin-bottom: 2rem;
}

.success-content i {
    font-size: var(--text-3xl);
    color: var(--success-color);
}

.success-content h3 {
    font-size: var(--text-xl);
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: 0.5rem;
}

.success-content p {
    color: var(--text-secondary);
    margin: 0;
}

.success-actions {
    display: flex;
    justify-content: center;
}

.auth-alternatives {
    text-align: center;
}

.auth-alternatives p {
    color: var(--text-secondary);
    margin-bottom: 1rem;
}

.help-steps {
    margin-bottom: 2rem;
}

.help-step {
    display: flex;
    gap: 1rem;
    margin-bottom: 2rem;
    align-items: flex-start;
}

.step-number {
    width: 40px;
    height: 40px;
    background: rgba(255, 255, 255, 0.2);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-weight: 600;
    flex-shrink: 0;
}

.step-content h3 {
    color: white;
    font-size: var(--text-lg);
    margin-bottom: 0.5rem;
}

.step-content p {
    color: rgba(255, 255, 255, 0.9);
    font-size: var(--text-sm);
    line-height: var(--leading-relaxed);
    margin: 0;
}

.security-note {
    display: flex;
    gap: 1rem;
    padding: 1.5rem;
    background: rgba(255, 255, 255, 0.1);
    border-radius: var(--radius-lg);
    align-items: flex-start;
}

.security-note i {
    color: white;
    font-size: var(--text-xl);
    flex-shrink: 0;
    margin-top: 0.25rem;
}

.security-note h4 {
    color: white;
    font-size: var(--text-base);
    margin-bottom: 0.5rem;
}

.security-note p {
    color: rgba(255, 255, 255, 0.9);
    font-size: var(--text-sm);
    line-height: var(--leading-relaxed);
    margin: 0;
}

.field-error {
    color: var(--error-color);
    font-size: var(--text-sm);
    margin-top: 0.25rem;
    display: flex;
    align-items: center;
    gap: 0.25rem;
}

.field-error::before {
    content: 'âš ';
    font-size: var(--text-xs);
}

@media (max-width: 768px) {
    .success-content {
        flex-direction: column;
        text-align: center;
    }
    
    .help-step {
        flex-direction: column;
        text-align: center;
        gap: 0.5rem;
    }
    
    .step-number {
        margin: 0 auto;
    }
    
    .security-note {
        flex-direction: column;
        text-align: center;
        gap: 1rem;
    }
}
</style>